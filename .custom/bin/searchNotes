#!/bin/bash
cd ~/Dropbox/Notes

set -e

main() {
  file_to_edit=`select_file`

  if [ -n "$file_to_edit" ] ; then
    "$EDITOR" "$file_to_edit"
    main ""
  fi
}



select_file() {
    # grep all files | use fzf (preview - split by :, pass file ($0) and hit found by grep "$*" to another grep to show first and last 5 lines around the hit) | Cut occ. before : which is filename 
    output=`grep --line-buffered --color=never -r "" * | fzf --preview='echo {} | sed "s/:/ /" | xargs bash -c '\''grep --color=always -r -B 5 -A 5 "$*" $0'\' --preview-window=right:50%:wrap | cut -d: -f1`
    echo "$output"
}

main ""
